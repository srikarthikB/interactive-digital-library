<!DOCTYPE html>
<html lang="en">
<head>
    <title>{{ book.title }}</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Serif font for library feel -->
    <style>
        body {
            font-family: Georgia, "Times New Roman", serif;
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br
             from-[#5D4037] via-[#EFEBE9] to-[#5D4037]
             p-8">

    <div class="max-w-3xl mx-auto bg-[#FAF7F2]/95 backdrop-blur-sm rounded-3xl p-8
            text-[#3E2723] shadow-2xl">

    <!-- BREADCRUMB -->
    <nav class="text-sm text-[#6D4C41] mb-4">
        <a href="/" class="hover:text-[#3E2723] underline">Home</a>
        <span class="mx-2">‚Üí</span>
        <span class="text-[#3E2723] font-semibold">{{ book.title }}</span>
    </nav>


    <!-- TITLE -->
    <h1 class="text-3xl font-bold mb-4">{{ book.title }}</h1>

    <span class="inline-block text-xs px-3 py-1 rounded-full
                bg-[#EFEBE9] text-[#5D4037] mb-4">
        {{ book.status }}
    </span>

    <p class="text-sm text-[#6D4C41] mb-4">
        {{ book.author }} ‚Ä¢ {{ book.genre }} ‚Ä¢ {{ book.era }}
    </p>

    <!-- DESCRIPTION -->
    <p class="text-[#4E342E] mb-6 leading-relaxed">
        {{ book.description }}
    </p>
    
<!-- AI SUMMARY -->
<div class="mt-8">

    <h3 class="text-xl font-semibold mb-3 text-[#3E2723]">
        AI Summary
    </h3>

    {% if summary %}

        <!-- Short summary -->
        <p class="text-[#4E342E] leading-relaxed">
            {{ summary.short }}
        </p>

        <!-- Read more button -->
        <button
            onclick="document.getElementById('full-summary').classList.toggle('hidden')"
            class="mt-3 text-sm text-[#6D4C41] hover:text-[#3E2723] underline"
        >
            Read full AI summary
        </button>

        <!-- Full summary -->
        <div id="full-summary"
            class="hidden mt-4 transition-all duration-300 ease-in-out">
            <p class="text-[#4E342E] leading-relaxed whitespace-pre-line">
                {{ summary.full }}
            </p>
        </div>

    {% else %}

        <p class="text-sm italic text-[#6D4C41] mt-2">
            AI summary not available for this book yet.
        </p>

    {% endif %}

</div>

<!-- AI TRANSPARENCY NOTE -->
<p class="mt-6 text-xs italic text-[#6D4C41] max-w-xl">
    AI-generated summaries are intended as pre-reading aids and may not fully
    capture the depth or nuances of the original text.
</p>

    <!-- AUDIO -->
    <div class="mt-6">
        <button
            onclick="document.getElementById('audio-player').classList.toggle('hidden')"
            class="flex items-center gap-2 text-sm text-[#6D4C41] hover:text-[#3E2723]"
        >
            üîä Listen to audio version
        </button>

        <div id="audio-player" class="hidden mt-3">
            <audio controls class="w-full">
                <source src="{{ url_for('static', filename='audio/' + book.slug + '.mp3') }}" type="audio/mpeg">
            </audio>
        </div>
    </div>

    <!-- ACTION SECTION -->
<div class="mt-8">

    {% if book.archive_link %}
        <!-- PUBLIC DOMAIN / EXTERNAL ACCESS -->
        <div class="flex flex-wrap gap-4">
            <a
              href="{{ book.archive_link }}"
              target="_blank"
              class="px-6 py-3 rounded-xl bg-[#6D4C41] text-[#FAF7F2]
                     font-semibold hover:bg-[#5D4037] transition"
            >
              Read Book
            </a>

            <a
              href="/book/{{ book.id }}/visuals"
              class="px-6 py-3 rounded-xl bg-[#D7CCC8] text-[#3E2723]
                     hover:bg-[#BCAAA4] transition font-semibold"
            >
              View AI Visual Summary
            </a>
        </div>

    {% else %}
        <!-- COPYRIGHTED BOOK WARNING -->
        <div class="mt-6 p-4 rounded-xl bg-red-500/20 border border-red-400">
            <h3 class="font-semibold text-red-700 mb-2">
                ‚ö† Copyright Notice
            </h3>

            <p class="text-red-800 text-sm leading-relaxed">
                This book is protected under copyright law and is not available for
                full reading on this platform. Only AI-generated summaries and visual
                aids are provided for educational purposes.
            </p>

            <a
              href="/about"
              class="inline-block mt-3 text-sm text-red-700 underline hover:text-red-900"
            >
              Read our content & copyright guidelines ‚Üí
            </a>
        </div>
    {% endif %}

    <a
        href="/"
        class="block mt-10 text-[#6D4C41] hover:text-[#3E2723]"
        >
        ‚Üê Back to Home
    </a>

</div>
</body>
</html>
